<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Votify TV</title>

<style>
body{
  margin:0;
  background:#0f1220;
  color:white;
  font-family:Arial, sans-serif;
  display:flex;
  height:100vh;
}

.video{
  flex:2;
  background:black;
}

.sidebar{
  flex:1;
  padding:40px;
  background:#151829;
  display:flex;
  flex-direction:column;
  gap:20px;
}

h2{
  margin:0;
}

.qr-box{
  background:white;
  padding:20px;
  border-radius:16px;
  width:240px;
  height:240px;
  display:flex;
  align-items:center;
  justify-content:center;
}

#voteLink{
  font-size:14px;
  opacity:.8;
  word-break:break-all;
}
</style>
</head>

<body>

<div class="video"></div>

<div class="sidebar">
  <h2>ðŸ“± Escanea para votar</h2>

  <div class="qr-box">
    <canvas id="qr"></canvas>
  </div>

  <div id="voteLink"></div>
</div>

<script src="/vendor/qrcode.min.js"></script>

<script>
const roomId = window.location.pathname.split("/").pop();
const voteUrl = window.location.origin + "/r/" + roomId;

document.getElementById("voteLink").innerText = voteUrl;

function generateQR(){
  if(!window.QRCode){
    document.getElementById("qr").replaceWith(
      Object.assign(document.createElement("div"), {
        innerText: "QR no disponible",
        style: "color:black;font-weight:bold"
      })
    );
    return;
  }

  QRCode.toCanvas(document.getElementById("qr"), voteUrl, {
    width:200,
    margin:2
  });
}

generateQR();
</script>

</body>
</html>